<html>
<head>
    <!-- Meta SEO -->
    <title>
        Threat Model
    </title>

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="./icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="./icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./icons/favicon-16x16.png">
    <link rel="manifest" href="./icons/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="./icons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Dependencies -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/formiojs@latest/dist/formio.full.min.css">
    <script src="https://unpkg.com/formiojs@latest/dist/formio.full.min.js"></script>

    <script type="text/javascript">
        let formSchema = {
            "display": "form",
            "components": [
                {
                    "label": "Title",
                    "allowMultipleMasks": false,
                    "showWordCount": false,
                    "showCharCount": false,
                    "tableView": true,
                    "type": "textfield",
                    "input": true,
                    "key": "title",
                    "validate": {
                        "required": true,
                        "unique": false,
                        "customMessage": "",
                        "json": ""
                    },
                    "widget": {
                        "type": ""
                    }
                },
                {
                    "columns": [
                        {
                            "components": [
                                {
                                    "label": "Panel",
                                    "title": "Meta",
                                    "mask": false,
                                    "tableView": false,
                                    "type": "panel",
                                    "input": false,
                                    "key": "panel",
                                    "components": [
                                        {
                                            "label": "Reporter Email",
                                            "tableView": true,
                                            "type": "email",
                                            "input": true,
                                            "key": "reporterEmail",
                                            "validate": {
                                                "required": true,
                                                "unique": false,
                                                "customMessage": "",
                                                "json": ""
                                            }
                                        },
                                        {
                                            "label": "First Reported",
                                            "format": "yyyy-MM-dd",
                                            "mask": false,
                                            "tableView": true,
                                            "type": "datetime",
                                            "input": true,
                                            "key": "firstReported",
                                            "suffix": true,
                                            "widget": {
                                                "type": "calendar",
                                                "displayInTimezone": "viewer",
                                                "language": "en",
                                                "useLocaleSettings": false,
                                                "allowInput": true,
                                                "mode": "single",
                                                "enableTime": false,
                                                "noCalendar": false,
                                                "format": "yyyy-MM-dd",
                                                "defaultDate": "",
                                                "hourIncrement": 1,
                                                "minuteIncrement": 1,
                                                "time_24hr": false,
                                                "minDate": null,
                                                "maxDate": null
                                            },
                                            "validate": {
                                                "required": true,
                                                "unique": false,
                                                "customMessage": "",
                                                "json": ""
                                            }
                                        }
                                    ]
                                },
                                {
                                    "label": "Panel",
                                    "title": "Summary",
                                    "mask": false,
                                    "tableView": false,
                                    "type": "panel",
                                    "input": false,
                                    "key": "panel",
                                    "components": [
                                        {
                                            "label": "Priority",
                                            "mask": false,
                                            "tableView": true,
                                            "type": "select",
                                            "input": true,
                                            "key": "priority",
                                            "defaultValue": "",
                                            "data": {
                                                "values": [
                                                    {
                                                        "label": "None",
                                                        "value": "none"
                                                    },
                                                    {
                                                        "label": "Low",
                                                        "value": "low"
                                                    },
                                                    {
                                                        "label": "Medium",
                                                        "value": "medium"
                                                    },
                                                    {
                                                        "label": "High",
                                                        "value": "high"
                                                    },
                                                    {
                                                        "label": "Critical",
                                                        "value": "critical"
                                                    }
                                                ]
                                            },
                                            "validate": {
                                                "required": true,
                                                "unique": false,
                                                "customMessage": "",
                                                "json": ""
                                            },
                                            "valueProperty": "value"
                                        },
                                        {
                                            "label": "Attack Description",
                                            "showWordCount": false,
                                            "showCharCount": false,
                                            "tableView": true,
                                            "type": "textarea",
                                            "input": true,
                                            "key": "attackDescription",
                                            "widget": {
                                                "type": ""
                                            },
                                            "validate": {
                                                "required": true,
                                                "unique": false,
                                                "customMessage": "",
                                                "json": ""
                                            }
                                        },
                                        {
                                            "label": "Risk Type",
                                            "mask": false,
                                            "tableView": true,
                                            "type": "select",
                                            "input": true,
                                            "key": "riskType",
                                            "defaultValue": "",
                                            "data": {
                                                "values": [
                                                    {
                                                        "label": "White",
                                                        "value": "white"
                                                    },
                                                    {
                                                        "label": "Grey",
                                                        "value": "grey"
                                                    },
                                                    {
                                                        "label": "Black",
                                                        "value": "black"
                                                    }
                                                ]
                                            },
                                            "valueProperty": "value"
                                        },
                                        {
                                            "label": "Entrypoint",
                                            "showWordCount": false,
                                            "showCharCount": false,
                                            "tableView": true,
                                            "type": "textfield",
                                            "input": true,
                                            "key": "entrypoint",
                                            "widget": {
                                                "type": ""
                                            }
                                        }
                                    ]
                                }
                            ],
                            "width": 4,
                            "offset": 0,
                            "push": 0,
                            "pull": 0,
                            "type": "column",
                            "input": true,
                            "key": "",
                            "tableView": true,
                            "label": ""
                        },
                        {
                            "components": [
                                {
                                    "components": [
                                        {
                                            "label": "Impact",
                                            "key": "impact",
                                            "components": [
                                                {
                                                    "label": "Resources",
                                                    "tooltip": "What are you trying to protect?",
                                                    "multiple": true,
                                                    "showWordCount": false,
                                                    "showCharCount": false,
                                                    "tableView": true,
                                                    "type": "textfield",
                                                    "input": true,
                                                    "key": "resources",
                                                    "tab": 0,
                                                    "widget": {
                                                        "type": ""
                                                    }
                                                },
                                                {
                                                    "addAnotherPosition": "bottom",
                                                    "label": "Threats",
                                                    "disableAddingRemovingRows": false,
                                                    "defaultOpen": false,
                                                    "addAnother": "",
                                                    "mask": false,
                                                    "tableView": true,
                                                    "type": "datagrid",
                                                    "input": true,
                                                    "key": "threats",
                                                    "components": [
                                                        {
                                                            "label": "STRIDE Category",
                                                            "mask": false,
                                                            "tableView": true,
                                                            "type": "select",
                                                            "input": true,
                                                            "key": "stride",
                                                            "defaultValue": "",
                                                            "data": {
                                                                "values": [
                                                                    {
                                                                        "label": "Spoofing",
                                                                        "value": "spoofing"
                                                                    },
                                                                    {
                                                                        "label": "Tampering",
                                                                        "value": "tampering"
                                                                    },
                                                                    {
                                                                        "label": "Repudiation",
                                                                        "value": "repudiation"
                                                                    },
                                                                    {
                                                                        "label": "Information Disclosure",
                                                                        "value": "informationDisclosure"
                                                                    },
                                                                    {
                                                                        "label": "Denial Of Service",
                                                                        "value": "denialOfService"
                                                                    },
                                                                    {
                                                                        "label": "Elevation Of Privelege",
                                                                        "value": "elevationOfPrivelege"
                                                                    }
                                                                ]
                                                            },
                                                            "row": "0-0",
                                                            "valueProperty": "value"
                                                        },
                                                        {
                                                            "label": "Description",
                                                            "showWordCount": false,
                                                            "showCharCount": false,
                                                            "tableView": true,
                                                            "type": "textfield",
                                                            "input": true,
                                                            "key": "description",
                                                            "widget": {
                                                                "type": ""
                                                            },
                                                            "row": "0-1"
                                                        }
                                                    ],
                                                    "tab": 0
                                                },
                                                {
                                                    "questions": [
                                                        {
                                                            "label": "How likely is the attacker to be able to carry out the attack?",
                                                            "value": "howLikelyIsTheAttackerToBeAbleToCarryOutTheAttack"
                                                        }
                                                    ],
                                                    "values": [
                                                        {
                                                            "label": "Very Unlikely",
                                                            "value": "veryUnlikely"
                                                        },
                                                        {
                                                            "label": "Unlikely",
                                                            "value": "unlikely"
                                                        },
                                                        {
                                                            "label": "Neither",
                                                            "value": "neither"
                                                        },
                                                        {
                                                            "label": "Likely",
                                                            "value": "likely"
                                                        },
                                                        {
                                                            "label": "Very Likely",
                                                            "value": "veryLikely"
                                                        },
                                                        {
                                                            "label": "Unsure",
                                                            "value": "unsure"
                                                        }
                                                    ],
                                                    "label": "Capability",
                                                    "mask": false,
                                                    "tableView": true,
                                                    "type": "survey",
                                                    "input": true,
                                                    "key": "capability",
                                                    "customClass": "table-responsive"
                                                },
                                                {
                                                    "questions": [
                                                        {
                                                            "label": "How frequently is the attacker able to carry out the attack?",
                                                            "value": "howFrequentlyIsTheAttackerAbleToCarryOutTheAttack"
                                                        }
                                                    ],
                                                    "values": [
                                                    {
                                                            "label": "Never",
                                                            "value": "never"
                                                        },
                                                        {
                                                            "label": "Rarely",
                                                            "value": "rarely"
                                                        },
                                                        {
                                                            "label": "Sometimes",
                                                            "value": "sometimes"
                                                        },
                                                        {
                                                            "label": "Often",
                                                            "value": "often"
                                                        },
                                                        {
                                                            "label": "Always",
                                                            "value": "always"
                                                        },
                                                        {
                                                            "label": "Unsure",
                                                            "value": "unsure"
                                                        }
                                                    ],
                                                    "label": "Frequency",
                                                    "mask": false,
                                                    "tableView": true,
                                                    "type": "survey",
                                                    "input": true,
                                                    "key": "frequency",
                                                    "properties": {},
                                                    "tags": [],
                                                    "customClass": "table-responsive"
                                                },
                                                {
                                                    "addAnotherPosition": "bottom",
                                                    "label": "Loss Magnitude",
                                                    "disableAddingRemovingRows": false,
                                                    "defaultOpen": false,
                                                    "addAnother": "",
                                                    "mask": false,
                                                    "tableView": true,
                                                    "type": "datagrid",
                                                    "input": true,
                                                    "key": "lossMagnitude",
                                                    "components": [
                                                        {
                                                            "label": "Form",
                                                            "mask": false,
                                                            "tableView": true,
                                                            "type": "select",
                                                            "input": true,
                                                            "key": "form",
                                                            "defaultValue": "",
                                                            "data": {
                                                                "values": [
                                                                    {
                                                                        "label": "Productivity",
                                                                        "value": "productivity"
                                                                    },
                                                                    {
                                                                        "label": "Response",
                                                                        "value": "response"
                                                                    },
                                                                    {
                                                                        "label": "Replacement",
                                                                        "value": "replacement"
                                                                    },
                                                                    {
                                                                        "label": "Fines",
                                                                        "value": "fines"
                                                                    },
                                                                    {
                                                                        "label": "Competitive Advantage",
                                                                        "value": "competitiveAdvantage"
                                                                    },
                                                                    {
                                                                        "label": "Reputation",
                                                                        "value": "reputation"
                                                                    },
                                                                    {
                                                                        "label": "Other",
                                                                        "value": "other"
                                                                    }
                                                                ]
                                                            },
                                                            "row": "0-0",
                                                            "valueProperty": "value"
                                                        },
                                                        {
                                                            "label": "Extent",
                                                            "showWordCount": false,
                                                            "showCharCount": false,
                                                            "tableView": true,
                                                            "type": "textfield",
                                                            "input": true,
                                                            "key": "extent",
                                                            "widget": {
                                                                "type": ""
                                                            },
                                                            "row": "0-1"
                                                        }
                                                    ],
                                                    "tab": 0
                                                }
                                            ]
                                        },
                                        {
                                            "label": "Probability",
                                            "key": "probability",
                                            "components": [
                                                {
                                                    "label": "Vulnerabilities",
                                                    "tooltip": "What problems exist currently?",
                                                    "multiple": true,
                                                    "showWordCount": false,
                                                    "showCharCount": false,
                                                    "tableView": true,
                                                    "type": "textfield",
                                                    "input": true,
                                                    "key": "vulnerabilities",
                                                    "tab": 1,
                                                    "widget": {
                                                        "type": ""
                                                    }
                                                },
                                                {
                                                    "label": "Mitigations",
                                                    "tooltip": "What already exists to help prevent the problems?",
                                                    "multiple": true,
                                                    "showWordCount": false,
                                                    "showCharCount": false,
                                                    "tableView": true,
                                                    "type": "textfield",
                                                    "input": true,
                                                    "key": "mitigations",
                                                    "tab": 1,
                                                    "widget": {
                                                        "type": ""
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "label": "Control Strategy",
                                            "key": "controlStrategy",
                                            "components": [
                                                {
                                                    "addAnotherPosition": "bottom",
                                                    "label": "Strategies",
                                                    "disableAddingRemovingRows": false,
                                                    "defaultOpen": false,
                                                    "addAnother": "",
                                                    "mask": false,
                                                    "tableView": true,
                                                    "type": "datagrid",
                                                    "input": true,
                                                    "key": "strategies",
                                                    "components": [
                                                        {
                                                            "label": "Control",
                                                            "mask": false,
                                                            "tableView": true,
                                                            "type": "select",
                                                            "input": true,
                                                            "key": "control",
                                                            "defaultValue": "",
                                                            "data": {
                                                                "values": [
                                                                    {
                                                                        "label": "Avoid",
                                                                        "value": "avoid"
                                                                    },
                                                                    {
                                                                        "label": "Transfer",
                                                                        "value": "transfer"
                                                                    },
                                                                    {
                                                                        "label": "Mitigate",
                                                                        "value": "mitigate"
                                                                    },
                                                                    {
                                                                        "label": "Accept",
                                                                        "value": "accept"
                                                                    }
                                                                ]
                                                            },
                                                            "row": "0-0",
                                                            "valueProperty": "value"
                                                        },
                                                        {
                                                            "label": "Description",
                                                            "showWordCount": false,
                                                            "showCharCount": false,
                                                            "tableView": true,
                                                            "type": "textfield",
                                                            "input": true,
                                                            "key": "description2",
                                                            "widget": {
                                                                "type": ""
                                                            }
                                                        }
                                                    ],
                                                    "tab": 2
                                                }
                                            ]
                                        },
                                        {
                                            "label": "Examples",
                                            "key": "examples",
                                            "components": [
                                            {
                                                            "label": "Hypothetical Example",
                                                            "showWordCount": false,
                                                            "showCharCount": false,
                                                            "tableView": true,
                                                            "type": "textarea",
                                                            "input": true,
                                                            "key": "hypotheticalExample",
                                                            "widget": {
                                                                "type": ""
                                                            }
                                                        },
                                                        {
                                                            "addAnotherPosition": "bottom",
                                                            "label": "Real-World Examples",
                                                            "disableAddingRemovingRows": false,
                                                            "defaultOpen": false,
                                                            "addAnother": "",
                                                            "multiple": true,
                                                            "mask": false,
                                                            "tableView": true,
                                                            "type": "datagrid",
                                                            "input": true,
                                                            "key": "realWorldExamples",
                                                            "components": [
                                                                {
                                                                    "label": "Reference URL",
                                                                    "allowMultipleMasks": false,
                                                                    "showWordCount": false,
                                                                    "showCharCount": false,
                                                                    "tableView": true,
                                                                    "type": "url",
                                                                    "input": true,
                                                                    "key": "referenceUrl",
                                                                    "widget": {
                                                                        "type": ""
                                                                    },
                                                                    "row": "0-0"
                                                                },
                                                                {
                                                                    "label": "Description",
                                                                    "allowMultipleMasks": false,
                                                                    "showWordCount": false,
                                                                    "showCharCount": false,
                                                                    "tableView": true,
                                                                    "type": "textfield",
                                                                    "input": true,
                                                                    "key": "description3",
                                                                    "defaultValue": "",
                                                                    "validate": {
                                                                        "unique": false,
                                                                        "customMessage": "",
                                                                        "json": ""
                                                                    },
                                                                    "inputFormat": "plain",
                                                                    "properties": {},
                                                                    "tags": [],
                                                                    "widget": {
                                                                        "type": ""
                                                                    },
                                                                    "row": "0-1"
                                                                }
                                                            ]
                                                        }
                                            ]
                                        }
                                    ],
                                    "label": "Groups",
                                    "hideLabel": true,
                                    "mask": false,
                                    "tableView": true,
                                    "type": "tabs",
                                    "input": false,
                                    "key": "groups"
                                }
                            ],
                            "width": 8,
                            "offset": 0,
                            "push": 0,
                            "pull": 0,
                            "type": "column",
                            "input": true,
                            "key": "",
                            "tableView": true,
                            "label": ""
                        }
                    ],
                    "label": "Columns",
                    "hideLabel": true,
                    "mask": false,
                    "tableView": false,
                    "type": "columns",
                    "input": false,
                    "key": "columns"
                },
                {
                    "type": "button",
                    "label": "Generate",
                    "key": "submit",
                    "customClass": "btn-block",
                    "disableOnInvalid": true,
                    "theme": "primary",
                    "input": true,
                    "tableView": true
                }
            ]
        };
    
        window.onload = function() {
            Formio.icons = 'fontawesome';
            Formio.createForm(document.getElementById('formio'), formSchema).then(function(form) {
                form.on('submit', function(submission) {
                    console.log(submission);
                    outputForm(renderForm(submission['data']));
                });
                return true;
            });
        };

        function renderForm(submission) {
            var rendered = "";

            // For each field, convert it markdown and add it to the string.
            rendered += formatTitle(1, submission['title']);

            rendered += formatTitle(2, 'Meta');

            if(submission['reporterEmail']) {
                rendered += formatTitle(3, 'Reporter');
                rendered += '[' + submission['reporterEmail'] + '](' + submission['reporterEmail'] + ')\n\n';
            }

            if(submission['firstReported']) {
                rendered += formatTitle(3, 'First Reported');
                rendered += new Date(submission['firstReported']).toDateString() + '\n\n';
            }

            rendered += formatTitle(2, 'Summary');

            if(submission['priority']) {
                rendered += formatTitle(3, 'Priority');
                rendered += upperCaseFirstLetter(submission['priority']) + '\n\n';
            }

            if(submission['attackDescription']) {
                rendered += formatTitle(3, 'Attack Description');
                rendered += submission['attackDescription'] + '\n\n';
            }

            if(submission['riskType']) {
                rendered += formatTitle(3, 'Risk Type');
                rendered += upperCaseFirstLetter(submission['riskType']) + '\n\n';
            }

            if(submission['entrypoint']) {
                rendered += formatTitle(3, 'Entry Point');
                rendered += submission['entrypoint'] + '\n\n';
            }

            rendered += formatTitle(2, 'Impact');

            if(submission['resources'] && submission['resources'].length > 0 && submission['resources'][0].length > 0) {
                rendered += formatTitle(3, 'Resources');
                for(let resource of submission['resources']) {
                    rendered += "- " + resource + '\n';
                }
                rendered += '\n\n';
            }

            if(submission['threats'] && submission['threats'].length > 0 && submission['threats'][0]['stride'].length > 0) {
                rendered += formatTitle(3, 'Threats');
                for(let threat of submission['threats']) {
                    rendered += formatTitle(4, camelCaseToNormalSentence(threat['stride']));
                    rendered += threat['description'] + '\n\n';
                }
                rendered += '\n\n';
            }

            if(submission['capability']['howLikelyIsTheAttackerToBeAbleToCarryOutTheAttack']) {
                rendered += formatTitle(3, 'Capability');
                rendered += camelCaseToNormalSentence(submission['capability']['howLikelyIsTheAttackerToBeAbleToCarryOutTheAttack']) + '\n\n';
            }

            if(submission['frequency']['howFrequentlyIsTheAttackerAbleToCarryOutTheAttack']) {
                rendered += formatTitle(3, 'Frequency');
                rendered += camelCaseToNormalSentence(submission['frequency']['howFrequentlyIsTheAttackerAbleToCarryOutTheAttack']) + '\n\n';
            }

            if(submission['lossMagnitude'] && submission['lossMagnitude'].length > 0 && submission['lossMagnitude'][0]['form'].length > 0) {
                rendered += formatTitle(3, 'Loss Magnitude');
                for(let form of submission['lossMagnitude']) {
                    rendered += formatTitle(4, upperCaseFirstLetter(form['form']));
                    rendered += form['extent'] + '\n\n';
                }
                rendered += '\n\n';
            }

            if((submission['vulnerabilities'] && submission['vulnerabilities'].length) || (submission['mitigations'] && submission['mitigations'].length > 0)) {
                rendered += formatTitle(2, 'Probability');
            }

            if(submission['vulnerabilities'] && submission['vulnerabilities'].length > 0 && submission['vulnerabilities'][0].length > 0) {
                rendered += formatTitle(3, 'Vulnerabilities');
                for(let vulnerability of submission['vulnerabilities']) {
                    rendered += "- " + vulnerability + '\n';
                }
                rendered += '\n\n';
            }

            if(submission['mitigations'] && submission['mitigations'].length > 0 && submission['mitigations'][0].length > 0) {
                rendered += formatTitle(3, 'Mitigations');
                for(let mitigation of submission['mitigations']) {
                    rendered += "- " + mitigation + '\n';
                }
                rendered += '\n\n';
            }

            if(submission['strategies'] && submission['strategies'].length > 0) {
                rendered += formatTitle(2, 'Control Strategy');
            }

            if(submission['strategies'] && submission['strategies'].length > 0 && submission['strategies'][0]['control'].length > 0) {
                rendered += formatTitle(3, 'Strategies');
                for(let control of submission['strategies']) {
                    rendered += formatTitle(4, upperCaseFirstLetter(control['control']));
                    rendered += control['description2'] + '\n\n';
                }
                rendered += '\n\n';
            }

            if(submission['hypotheticalExample'] || (submission['realWorldExamples'] && submission['realWorldExamples'].length)) {
                rendered += formatTitle(2, 'Examples');
            }

            if(submission['hypotheticalExample']) {
                rendered += formatTitle(3, 'Hypothetical Example');
                rendered += submission['hypotheticalExample'] + '\n\n';
            }

            if(submission['realWorldExamples'] && submission['realWorldExamples'].length > 0 && (submission['realWorldExamples'][0]['description3'].length > 0 || submission['realWorldExamples'][0]['referenceUrl'].length > 0)) {
                rendered += formatTitle(3, 'Real-World Examples');
                for(let realWorldExample of submission['realWorldExamples']) {
                    rendered += '- [' + realWorldExample['description3'] + '](' + realWorldExample['referenceUrl'] + ')\n\n';
                }
                rendered += '\n\n';
            }

            return rendered;
        }

        function outputForm(rendered) {
            document.getElementById("output").value = rendered;
        }

        function formatTitle(level, text) {
            if(text == null || text == undefined) {
                return "";
            }
            var titleString = "";
            for(var i = 0; i < level; i++) {
                titleString += "#";
            }
            return titleString += " " + text + "\n\n";
        }

        function upperCaseFirstLetter(text) {
            return text.replace(/^\w/, c => c.toUpperCase());
        }

        function camelCaseToNormalSentence(text) {
            return upperCaseFirstLetter(text.replace(/([A-Z])/g, ' $1'));
        }
    </script>
    <style>
        html {
            background-image: linear-gradient(#eee 10%, #fff);
        }
        body {
            
            background: url('./circuit.svg');
            background-size: cover;
            background-repeat: no-repeat;
        }
        #nav {
            padding: 2rem;
        }
        .nav.nav-tabs {
            margin-bottom: 1rem;
        }
        .formio-component-submit {
            margin-top: 1rem;
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="bg-dark text-white">
        <div id="nav" class="container">
            <h1>Threat Modelling Template Utility</h1>
        </div>
    </div>
    <!-- Explanation -->
    <div id="wrapper" class="container pb-4 pt-4">
        <div class="col">
            <p class="lead mt-2 mb-4">
                This tool provides a genericised template for producing risk analyses according to a combination of statistical, mathematical and computational heuristics.
                It is intended to be used by teams wishing to increase awareness of security issues arising from technical debt.
            </p>
            <div class="alert alert-primary alert-dismissible fade show mb-4" role="alert">
                <h4 class="alert-heading">
                    Definitions
                </h4>
                <p>
                    A <em>threat</em> is way of causing damage to a system.
                    A <em>vulnerability</em> is a flaw in the system that makes it possible for a threat to occur.
                    An <em>attack</em> on a system is the realization of a threat through the exploitation of one or more vulnerabilities.
                    <em>The risk of an attack is the probability of that attack to occurs multiplied by its impact.</em>
                </p>
                <p>
                    This tool outputs Markdown-formatted text for flexibility in integration.
                </p>
                <hr />
                <p>
                    For further information refer to company-specific documentation, including frameworks such as the <a href="https://en.wikipedia.org/wiki/STRIDE_(security)">STRIDE</a>,
                    <a href="https://en.wikipedia.org/wiki/Factor_analysis_of_information_risk">FAIR, <a href="https://en.wikipedia.org/wiki/Attack_tree">attack-tree</a> and <a href="https://en.wikipedia.org/wiki/Data_flow_diagram">DFD</a> models.
                </p>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- Form Render -->
            <div class="card mb-4">
                <h3 class="card-header">Create Risk Analysis</h3>
                <div id="formio" class="card-body"></div>
            </div>
            <h2 class="mb-4">Formatted Output</h2>
            <textarea id="output" rows="10" class="form-control" placeholder="Markdown will appear here on submission."></textarea>
            <!-- Attribution -->
            <p class="text-muted mt-4">Created by Josh Hills for Jagex Games Ltd., using <a href="https://github.com/formio/formio">Formio</a> <a href="https://github.com/formio/formio/blob/master/LICENSE.txt">(BSD)</a></p>
        </div>
    </div>
</body>
</html>